SQL> @tests

Table dropped.


Table dropped.


Table created.


Table created.


9999 rows created.


9999 rows created.


9999 rows created.


Index created.


Index created.


PL/SQL procedure successfully completed.


PL/SQL procedure successfully completed.


System altered.


  COUNT(*)                                                                      
----------                                                                      
         1                                                                      


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  cf016xd0knzrh, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 1736604837                                                                                                                                                                             
                                                                                                                                                                                                        
--------------------------------------------------------------------------                                                                                                                              
| Id  | Operation         | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                              
--------------------------------------------------------------------------                                                                                                                              
|   0 | SELECT STATEMENT  |      |       |       |     1 (100)|          |                                                                                                                              
|   1 |  SORT AGGREGATE   |      |     1 |     4 |            |          |                                                                                                                              
|*  2 |   INDEX RANGE SCAN| T1I  |     1 |     4 |     1   (0)| 00:00:01 |                                                                                                                              
--------------------------------------------------------------------------                                                                                                                              
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - access("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  gvd4z9ba14uh3, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  1y9y6gg3r5sry, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 1317774485                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     1 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     4 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     4 |     1   (0)| 00:00:01 |     1 |     1 |                                                                                                        
|*  3 |    INDEX RANGE SCAN     | T2I  |     1 |     4 |     1   (0)| 00:00:01 |     1 |     1 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - access("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         0                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  dcvq5bcm8yqm9, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1+150000                                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 1317774485                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     1 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     5 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     5 |     1   (0)| 00:00:01 |     2 |     2 |                                                                                                        
|*  3 |    INDEX RANGE SCAN     | T2I  |     1 |     5 |     1   (0)| 00:00:01 |     2 |     2 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - access("ID"=150001)                                                                                                                                                                              
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         2                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  9jh4ms6ruztw2, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 611317447                                                                                                                                                                              
                                                                                                                                                                                                        
---------------------------------------------------------------------------------------------                                                                                                           
| Id  | Operation            | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
|   0 | SELECT STATEMENT     |      |       |       |    16 (100)|          |       |       |                                                                                                           
|   1 |  SORT AGGREGATE      |      |     1 |     4 |            |          |       |       |                                                                                                           
|   2 |   PARTITION RANGE ALL|      |     2 |     8 |    16   (0)| 00:00:01 |     1 |     2 |                                                                                                           
|*  3 |    TABLE ACCESS FULL | T2   |     2 |     8 |    16   (0)| 00:00:01 |     1 |     2 |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

20 rows selected.


 SUM(VAL2)                                                                                                                                                                                              
----------                                                                                                                                                                                              
  49995000                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  31pkfzpmx1b62, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                                                                                                                        
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|   2 |   TABLE ACCESS FULL| T1   |  9999 | 39996 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        

14 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9998                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  czjk2xd0vn20k, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 682288026                                                                                                                                                                              
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------------                                                                                                  
| Id  | Operation                     | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                  
------------------------------------------------------------------------------------------------------                                                                                                  
|   0 | SELECT STATEMENT              |      |       |       |     2 (100)|          |       |       |                                                                                                  
|   1 |  SORT AGGREGATE               |      |     1 |     5 |            |          |       |       |                                                                                                  
|   2 |   PARTITION RANGE ITERATOR    |      |  1000 |  5000 |     2   (0)| 00:00:01 |     1 |   KEY |                                                                                                  
|*  3 |    INDEX RANGE SCAN           | T2I  |  1000 |  5000 |     2   (0)| 00:00:01 |     1 |   KEY |                                                                                                  
|   4 |     SORT AGGREGATE            |      |     1 |     4 |            |          |       |       |                                                                                                  
|   5 |      INDEX FULL SCAN (MIN/MAX)| T1I  |     1 |     4 |     2   (0)| 00:00:01 |       |       |                                                                                                  
------------------------------------------------------------------------------------------------------                                                                                                  
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - access("ID"<)                                                                                                                                                                                    
                                                                                                                                                                                                        

22 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
        49                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  ax2r0jyjs0hbb, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where                                                                                                                                 
val2<50                                                                                                                                                                                                 
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |    49 |   196 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL2"<50)                                                                                                                                                                                
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  7c65qbgku7can, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p2)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 3928439236                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     8 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     8   (0)| 00:00:01 |     2 |     2 |                                                                                                                
|   3 |    INDEX FAST FULL SCAN | T2I  |  9999 |     8   (0)| 00:00:01 |     2 |     2 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  221p0y74xg65x, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p1)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 3928439236                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     7 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     7   (0)| 00:00:01 |     1 |     1 |                                                                                                                
|   3 |    INDEX FAST FULL SCAN | T2I  |  9999 |     7   (0)| 00:00:01 |     1 |     1 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


49 rows updated.


98 rows updated.


49 rows updated.


49 rows updated.


Commit complete.


SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 N                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 N                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    VALID                           0 N                    N                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         

14 rows selected.


no rows selected

SQL> --
SQL> -- CREATE INDEX (visible)
SQL> --
SQL> create index new1 on t1 (val2) deferred invalidation;

Index created.

SQL> create index new2 on t2 (val2) local deferred invalidation;

Index created.

SQL> set echo off

SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 Y                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 Y                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    VALID                           0 Y                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 Y                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    VALID                           0 Y                    N                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    VALID                           0 Y                    N                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    VALID                           0 Y                    N                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    VALID                           0 Y                    N                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    VALID                           0 Y                    N                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 Y                    N                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         

14 rows selected.


no rows selected

Press <CR>


Table dropped.


Table dropped.


Table created.


Table created.


9999 rows created.


9999 rows created.


9999 rows created.


Index created.


Index created.


PL/SQL procedure successfully completed.


PL/SQL procedure successfully completed.


System altered.


  COUNT(*)                                                                                                                                                                                                                                                                                                  
----------                                                                                                                                                                                                                                                                                                  
         1                                                                                                                                                                                                                                                                                                  


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  cf016xd0knzrh, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 1736604837                                                                                                                                                                             
                                                                                                                                                                                                        
--------------------------------------------------------------------------                                                                                                                              
| Id  | Operation         | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                              
--------------------------------------------------------------------------                                                                                                                              
|   0 | SELECT STATEMENT  |      |       |       |     1 (100)|          |                                                                                                                              
|   1 |  SORT AGGREGATE   |      |     1 |     4 |            |          |                                                                                                                              
|*  2 |   INDEX RANGE SCAN| T1I  |     1 |     4 |     1   (0)| 00:00:01 |                                                                                                                              
--------------------------------------------------------------------------                                                                                                                              
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - access("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  gvd4z9ba14uh3, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  1y9y6gg3r5sry, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 1317774485                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     1 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     4 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     4 |     1   (0)| 00:00:01 |     1 |     1 |                                                                                                        
|*  3 |    INDEX RANGE SCAN     | T2I  |     1 |     4 |     1   (0)| 00:00:01 |     1 |     1 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - access("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         0                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  dcvq5bcm8yqm9, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1+150000                                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 1317774485                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     1 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     5 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     5 |     1   (0)| 00:00:01 |     2 |     2 |                                                                                                        
|*  3 |    INDEX RANGE SCAN     | T2I  |     1 |     5 |     1   (0)| 00:00:01 |     2 |     2 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - access("ID"=150001)                                                                                                                                                                              
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         2                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  9jh4ms6ruztw2, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 611317447                                                                                                                                                                              
                                                                                                                                                                                                        
---------------------------------------------------------------------------------------------                                                                                                           
| Id  | Operation            | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
|   0 | SELECT STATEMENT     |      |       |       |    16 (100)|          |       |       |                                                                                                           
|   1 |  SORT AGGREGATE      |      |     1 |     4 |            |          |       |       |                                                                                                           
|   2 |   PARTITION RANGE ALL|      |     2 |     8 |    16   (0)| 00:00:01 |     1 |     2 |                                                                                                           
|*  3 |    TABLE ACCESS FULL | T2   |     2 |     8 |    16   (0)| 00:00:01 |     1 |     2 |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

20 rows selected.


 SUM(VAL2)                                                                                                                                                                                              
----------                                                                                                                                                                                              
  49995000                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  31pkfzpmx1b62, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                                                                                                                        
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|   2 |   TABLE ACCESS FULL| T1   |  9999 | 39996 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        

14 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9998                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  czjk2xd0vn20k, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 682288026                                                                                                                                                                              
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------------                                                                                                  
| Id  | Operation                     | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                  
------------------------------------------------------------------------------------------------------                                                                                                  
|   0 | SELECT STATEMENT              |      |       |       |     2 (100)|          |       |       |                                                                                                  
|   1 |  SORT AGGREGATE               |      |     1 |     5 |            |          |       |       |                                                                                                  
|   2 |   PARTITION RANGE ITERATOR    |      |  1000 |  5000 |     2   (0)| 00:00:01 |     1 |   KEY |                                                                                                  
|*  3 |    INDEX RANGE SCAN           | T2I  |  1000 |  5000 |     2   (0)| 00:00:01 |     1 |   KEY |                                                                                                  
|   4 |     SORT AGGREGATE            |      |     1 |     4 |            |          |       |       |                                                                                                  
|   5 |      INDEX FULL SCAN (MIN/MAX)| T1I  |     1 |     4 |     2   (0)| 00:00:01 |       |       |                                                                                                  
------------------------------------------------------------------------------------------------------                                                                                                  
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - access("ID"<)                                                                                                                                                                                    
                                                                                                                                                                                                        

22 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
        49                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  ax2r0jyjs0hbb, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where                                                                                                                                 
val2<50                                                                                                                                                                                                 
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |    49 |   196 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL2"<50)                                                                                                                                                                                
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  7c65qbgku7can, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p2)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 3928439236                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     8 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     8   (0)| 00:00:01 |     2 |     2 |                                                                                                                
|   3 |    INDEX FAST FULL SCAN | T2I  |  9999 |     8   (0)| 00:00:01 |     2 |     2 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  221p0y74xg65x, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p1)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 3928439236                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     7 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     7   (0)| 00:00:01 |     1 |     1 |                                                                                                                
|   3 |    INDEX FAST FULL SCAN | T2I  |  9999 |     7   (0)| 00:00:01 |     1 |     1 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


49 rows updated.


98 rows updated.


49 rows updated.


49 rows updated.


Commit complete.


SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 N                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 N                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    VALID                           0 N                    N                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         

14 rows selected.


no rows selected

SQL> --
SQL> -- CREATE INDEX (invisible)
SQL> --
SQL> create index new1 on t1 (val2) invisible deferred invalidation;

Index created.

SQL> create index new2 on t2 (val2) invisible local deferred invalidation;

Index created.

SQL> set echo off

SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 Y                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 Y                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    VALID                           0 Y                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 Y                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    VALID                           0 Y                    N                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    VALID                           0 Y                    N                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    VALID                           0 Y                    N                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    VALID                           0 Y                    N                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    VALID                           0 Y                    N                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 Y                    N                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         

14 rows selected.


no rows selected

Press <CR>


Table dropped.


Table dropped.


Table created.


Table created.


9999 rows created.


9999 rows created.


9999 rows created.


Index created.


Index created.


PL/SQL procedure successfully completed.


PL/SQL procedure successfully completed.


System altered.


  COUNT(*)                                                                                                                                                                                                                                                                                                  
----------                                                                                                                                                                                                                                                                                                  
         1                                                                                                                                                                                                                                                                                                  


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  cf016xd0knzrh, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 1736604837                                                                                                                                                                             
                                                                                                                                                                                                        
--------------------------------------------------------------------------                                                                                                                              
| Id  | Operation         | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                              
--------------------------------------------------------------------------                                                                                                                              
|   0 | SELECT STATEMENT  |      |       |       |     1 (100)|          |                                                                                                                              
|   1 |  SORT AGGREGATE   |      |     1 |     4 |            |          |                                                                                                                              
|*  2 |   INDEX RANGE SCAN| T1I  |     1 |     4 |     1   (0)| 00:00:01 |                                                                                                                              
--------------------------------------------------------------------------                                                                                                                              
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - access("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  gvd4z9ba14uh3, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  1y9y6gg3r5sry, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 1317774485                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     1 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     4 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     4 |     1   (0)| 00:00:01 |     1 |     1 |                                                                                                        
|*  3 |    INDEX RANGE SCAN     | T2I  |     1 |     4 |     1   (0)| 00:00:01 |     1 |     1 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - access("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         0                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  dcvq5bcm8yqm9, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1+150000                                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 1317774485                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     1 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     5 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     5 |     1   (0)| 00:00:01 |     2 |     2 |                                                                                                        
|*  3 |    INDEX RANGE SCAN     | T2I  |     1 |     5 |     1   (0)| 00:00:01 |     2 |     2 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - access("ID"=150001)                                                                                                                                                                              
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         2                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  9jh4ms6ruztw2, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 611317447                                                                                                                                                                              
                                                                                                                                                                                                        
---------------------------------------------------------------------------------------------                                                                                                           
| Id  | Operation            | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
|   0 | SELECT STATEMENT     |      |       |       |    16 (100)|          |       |       |                                                                                                           
|   1 |  SORT AGGREGATE      |      |     1 |     4 |            |          |       |       |                                                                                                           
|   2 |   PARTITION RANGE ALL|      |     2 |     8 |    16   (0)| 00:00:01 |     1 |     2 |                                                                                                           
|*  3 |    TABLE ACCESS FULL | T2   |     2 |     8 |    16   (0)| 00:00:01 |     1 |     2 |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

20 rows selected.


 SUM(VAL2)                                                                                                                                                                                              
----------                                                                                                                                                                                              
  49995000                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  31pkfzpmx1b62, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                                                                                                                        
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|   2 |   TABLE ACCESS FULL| T1   |  9999 | 39996 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        

14 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9998                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  czjk2xd0vn20k, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 682288026                                                                                                                                                                              
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------------                                                                                                  
| Id  | Operation                     | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                  
------------------------------------------------------------------------------------------------------                                                                                                  
|   0 | SELECT STATEMENT              |      |       |       |     2 (100)|          |       |       |                                                                                                  
|   1 |  SORT AGGREGATE               |      |     1 |     5 |            |          |       |       |                                                                                                  
|   2 |   PARTITION RANGE ITERATOR    |      |  1000 |  5000 |     2   (0)| 00:00:01 |     1 |   KEY |                                                                                                  
|*  3 |    INDEX RANGE SCAN           | T2I  |  1000 |  5000 |     2   (0)| 00:00:01 |     1 |   KEY |                                                                                                  
|   4 |     SORT AGGREGATE            |      |     1 |     4 |            |          |       |       |                                                                                                  
|   5 |      INDEX FULL SCAN (MIN/MAX)| T1I  |     1 |     4 |     2   (0)| 00:00:01 |       |       |                                                                                                  
------------------------------------------------------------------------------------------------------                                                                                                  
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - access("ID"<)                                                                                                                                                                                    
                                                                                                                                                                                                        

22 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
        49                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  ax2r0jyjs0hbb, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where                                                                                                                                 
val2<50                                                                                                                                                                                                 
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |    49 |   196 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL2"<50)                                                                                                                                                                                
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  7c65qbgku7can, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p2)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 3928439236                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     8 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     8   (0)| 00:00:01 |     2 |     2 |                                                                                                                
|   3 |    INDEX FAST FULL SCAN | T2I  |  9999 |     8   (0)| 00:00:01 |     2 |     2 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  221p0y74xg65x, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p1)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 3928439236                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     7 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     7   (0)| 00:00:01 |     1 |     1 |                                                                                                                
|   3 |    INDEX FAST FULL SCAN | T2I  |  9999 |     7   (0)| 00:00:01 |     1 |     1 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


49 rows updated.


98 rows updated.


49 rows updated.


49 rows updated.


Commit complete.


SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 N                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 N                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    VALID                           0 N                    N                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         

14 rows selected.


no rows selected

SQL> --
SQL> -- DROP INDEX
SQL> --
SQL> drop index t1i deferred invalidation;

Index dropped.

SQL> drop index t2i deferred invalidation;

Index dropped.

SQL> set echo off

SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 Y                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 Y                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 Y                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 Y                    N                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         

14 rows selected.


no rows selected

Press <CR>


Table dropped.


Table dropped.


Table created.


Table created.


9999 rows created.


9999 rows created.


9999 rows created.


Index created.


Index created.


PL/SQL procedure successfully completed.


PL/SQL procedure successfully completed.


System altered.


  COUNT(*)                                                                                                                                                                                                                                                                                                  
----------                                                                                                                                                                                                                                                                                                  
         1                                                                                                                                                                                                                                                                                                  


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  cf016xd0knzrh, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 1736604837                                                                                                                                                                             
                                                                                                                                                                                                        
--------------------------------------------------------------------------                                                                                                                              
| Id  | Operation         | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                              
--------------------------------------------------------------------------                                                                                                                              
|   0 | SELECT STATEMENT  |      |       |       |     1 (100)|          |                                                                                                                              
|   1 |  SORT AGGREGATE   |      |     1 |     4 |            |          |                                                                                                                              
|*  2 |   INDEX RANGE SCAN| T1I  |     1 |     4 |     1   (0)| 00:00:01 |                                                                                                                              
--------------------------------------------------------------------------                                                                                                                              
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - access("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  gvd4z9ba14uh3, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  1y9y6gg3r5sry, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 1317774485                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     1 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     4 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     4 |     1   (0)| 00:00:01 |     1 |     1 |                                                                                                        
|*  3 |    INDEX RANGE SCAN     | T2I  |     1 |     4 |     1   (0)| 00:00:01 |     1 |     1 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - access("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         0                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  dcvq5bcm8yqm9, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1+150000                                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 1317774485                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     1 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     5 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     5 |     1   (0)| 00:00:01 |     2 |     2 |                                                                                                        
|*  3 |    INDEX RANGE SCAN     | T2I  |     1 |     5 |     1   (0)| 00:00:01 |     2 |     2 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - access("ID"=150001)                                                                                                                                                                              
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         2                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  9jh4ms6ruztw2, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 611317447                                                                                                                                                                              
                                                                                                                                                                                                        
---------------------------------------------------------------------------------------------                                                                                                           
| Id  | Operation            | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
|   0 | SELECT STATEMENT     |      |       |       |    15 (100)|          |       |       |                                                                                                           
|   1 |  SORT AGGREGATE      |      |     1 |     4 |            |          |       |       |                                                                                                           
|   2 |   PARTITION RANGE ALL|      |     2 |     8 |    15   (0)| 00:00:01 |     1 |     2 |                                                                                                           
|*  3 |    TABLE ACCESS FULL | T2   |     2 |     8 |    15   (0)| 00:00:01 |     1 |     2 |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

20 rows selected.


 SUM(VAL2)                                                                                                                                                                                              
----------                                                                                                                                                                                              
  49995000                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  31pkfzpmx1b62, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                                                                                                                        
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|   2 |   TABLE ACCESS FULL| T1   |  9999 | 39996 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        

14 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9998                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  czjk2xd0vn20k, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 682288026                                                                                                                                                                              
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------------                                                                                                  
| Id  | Operation                     | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                  
------------------------------------------------------------------------------------------------------                                                                                                  
|   0 | SELECT STATEMENT              |      |       |       |     2 (100)|          |       |       |                                                                                                  
|   1 |  SORT AGGREGATE               |      |     1 |     5 |            |          |       |       |                                                                                                  
|   2 |   PARTITION RANGE ITERATOR    |      |  1000 |  5000 |     2   (0)| 00:00:01 |     1 |   KEY |                                                                                                  
|*  3 |    INDEX RANGE SCAN           | T2I  |  1000 |  5000 |     2   (0)| 00:00:01 |     1 |   KEY |                                                                                                  
|   4 |     SORT AGGREGATE            |      |     1 |     4 |            |          |       |       |                                                                                                  
|   5 |      INDEX FULL SCAN (MIN/MAX)| T1I  |     1 |     4 |     2   (0)| 00:00:01 |       |       |                                                                                                  
------------------------------------------------------------------------------------------------------                                                                                                  
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - access("ID"<)                                                                                                                                                                                    
                                                                                                                                                                                                        

22 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
        49                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  ax2r0jyjs0hbb, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where                                                                                                                                 
val2<50                                                                                                                                                                                                 
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |    49 |   196 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL2"<50)                                                                                                                                                                                
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  7c65qbgku7can, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p2)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 3928439236                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     8 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     8   (0)| 00:00:01 |     2 |     2 |                                                                                                                
|   3 |    INDEX FAST FULL SCAN | T2I  |  9999 |     8   (0)| 00:00:01 |     2 |     2 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  221p0y74xg65x, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p1)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 3928439236                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     7 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     7   (0)| 00:00:01 |     1 |     1 |                                                                                                                
|   3 |    INDEX FAST FULL SCAN | T2I  |  9999 |     7   (0)| 00:00:01 |     1 |     1 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


49 rows updated.


98 rows updated.


49 rows updated.


49 rows updated.


Commit complete.


SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 N                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 N                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    VALID                           0 N                    N                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         

14 rows selected.


no rows selected

SQL> --
SQL> -- INDEX UNUSABLE
SQL> --
SQL> alter index t1i unusable deferred invalidation;

Index altered.

SQL> alter index t2i modify partition p1i unusable deferred invalidation;
alter index t2i modify partition p1i unusable deferred invalidation
                                              *
ERROR at line 1:
ORA-14048: a partition maintenance operation may not be combined with other operations 


SQL> 
SQL> alter session set CURSOR_INVALIDATION = 'deferred';

Session altered.

SQL> alter index t2i modify partition p1i unusable;

Index altered.

SQL> alter session set CURSOR_INVALIDATION = 'immediate';

Session altered.

SQL> 
SQL> set echo off

SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 Y                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 Y                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 Y                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         

14 rows selected.


no rows selected

Press <CR>


Table dropped.


Table dropped.


Table created.


Table created.


9999 rows created.


9999 rows created.


9999 rows created.


Index created.


Index created.


PL/SQL procedure successfully completed.


PL/SQL procedure successfully completed.


System altered.


  COUNT(*)                                                                                                                                                                                                                                                                                                  
----------                                                                                                                                                                                                                                                                                                  
         1                                                                                                                                                                                                                                                                                                  


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  cf016xd0knzrh, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 1736604837                                                                                                                                                                             
                                                                                                                                                                                                        
--------------------------------------------------------------------------                                                                                                                              
| Id  | Operation         | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                              
--------------------------------------------------------------------------                                                                                                                              
|   0 | SELECT STATEMENT  |      |       |       |     1 (100)|          |                                                                                                                              
|   1 |  SORT AGGREGATE   |      |     1 |     4 |            |          |                                                                                                                              
|*  2 |   INDEX RANGE SCAN| T1I  |     1 |     4 |     1   (0)| 00:00:01 |                                                                                                                              
--------------------------------------------------------------------------                                                                                                                              
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - access("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  gvd4z9ba14uh3, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     8 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     8   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  1y9y6gg3r5sry, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 1317774485                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     1 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     4 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     4 |     1   (0)| 00:00:01 |     1 |     1 |                                                                                                        
|*  3 |    INDEX RANGE SCAN     | T2I  |     1 |     4 |     1   (0)| 00:00:01 |     1 |     1 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - access("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         0                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  dcvq5bcm8yqm9, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1+150000                                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 1317774485                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     1 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     5 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     5 |     1   (0)| 00:00:01 |     2 |     2 |                                                                                                        
|*  3 |    INDEX RANGE SCAN     | T2I  |     1 |     5 |     1   (0)| 00:00:01 |     2 |     2 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - access("ID"=150001)                                                                                                                                                                              
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         2                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  9jh4ms6ruztw2, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 611317447                                                                                                                                                                              
                                                                                                                                                                                                        
---------------------------------------------------------------------------------------------                                                                                                           
| Id  | Operation            | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
|   0 | SELECT STATEMENT     |      |       |       |    16 (100)|          |       |       |                                                                                                           
|   1 |  SORT AGGREGATE      |      |     1 |     4 |            |          |       |       |                                                                                                           
|   2 |   PARTITION RANGE ALL|      |     2 |     8 |    16   (0)| 00:00:01 |     1 |     2 |                                                                                                           
|*  3 |    TABLE ACCESS FULL | T2   |     2 |     8 |    16   (0)| 00:00:01 |     1 |     2 |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

20 rows selected.


 SUM(VAL2)                                                                                                                                                                                              
----------                                                                                                                                                                                              
  49995000                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  31pkfzpmx1b62, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                                                                                                                        
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     8 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|   2 |   TABLE ACCESS FULL| T1   |  9999 | 39996 |     8   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        

14 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9998                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  czjk2xd0vn20k, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 682288026                                                                                                                                                                              
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------------                                                                                                  
| Id  | Operation                     | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                  
------------------------------------------------------------------------------------------------------                                                                                                  
|   0 | SELECT STATEMENT              |      |       |       |     2 (100)|          |       |       |                                                                                                  
|   1 |  SORT AGGREGATE               |      |     1 |     5 |            |          |       |       |                                                                                                  
|   2 |   PARTITION RANGE ITERATOR    |      |  1000 |  5000 |     2   (0)| 00:00:01 |     1 |   KEY |                                                                                                  
|*  3 |    INDEX RANGE SCAN           | T2I  |  1000 |  5000 |     2   (0)| 00:00:01 |     1 |   KEY |                                                                                                  
|   4 |     SORT AGGREGATE            |      |     1 |     4 |            |          |       |       |                                                                                                  
|   5 |      INDEX FULL SCAN (MIN/MAX)| T1I  |     1 |     4 |     2   (0)| 00:00:01 |       |       |                                                                                                  
------------------------------------------------------------------------------------------------------                                                                                                  
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - access("ID"<)                                                                                                                                                                                    
                                                                                                                                                                                                        

22 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
        49                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  ax2r0jyjs0hbb, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where                                                                                                                                 
val2<50                                                                                                                                                                                                 
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     8 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |    49 |   196 |     8   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL2"<50)                                                                                                                                                                                
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  7c65qbgku7can, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p2)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 3928439236                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     8 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     8   (0)| 00:00:01 |     2 |     2 |                                                                                                                
|   3 |    INDEX FAST FULL SCAN | T2I  |  9999 |     8   (0)| 00:00:01 |     2 |     2 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  221p0y74xg65x, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p1)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 3928439236                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     7 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     7   (0)| 00:00:01 |     1 |     1 |                                                                                                                
|   3 |    INDEX FAST FULL SCAN | T2I  |  9999 |     7   (0)| 00:00:01 |     1 |     1 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


49 rows updated.


98 rows updated.


49 rows updated.


49 rows updated.


Commit complete.


SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 N                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 N                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    VALID                           0 N                    N                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         

14 rows selected.


no rows selected

SQL> --
SQL> -- INDEX REBUILD
SQL> --
SQL> alter index t1i rebuild deferred invalidation;

Index altered.

SQL> alter index t2i rebuild partition p1i deferred invalidation;

Index altered.

SQL> set echo off

SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 Y                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 Y                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    VALID                           0 N                    Y                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 Y                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    VALID                           0 N                    Y                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    VALID                           0 N                    Y                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    VALID                           0 N                    Y                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    VALID                           0 N                    Y                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    VALID                           0 N                    Y                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    Y                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    Y                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    Y                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    Y                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    Y                    N                                                                                         

14 rows selected.


no rows selected


Table dropped.


Table dropped.


Table created.


Table created.


9999 rows created.


9999 rows created.


9999 rows created.


Index created.


Index created.


PL/SQL procedure successfully completed.


PL/SQL procedure successfully completed.

Get rid of indexes...
SQL> drop index t1i;

Index dropped.

SQL> drop index t2i;

Index dropped.

SQL> set echo off

System altered.


  COUNT(*)                                                                                                                                                                                                                                                                                                  
----------                                                                                                                                                                                                                                                                                                  
         1                                                                                                                                                                                                                                                                                                  


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  cf016xd0knzrh, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  gvd4z9ba14uh3, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  1y9y6gg3r5sry, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     9 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     4 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     4 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                        
|*  3 |    TABLE ACCESS FULL    | T2   |     1 |     4 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         0                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  dcvq5bcm8yqm9, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1+150000                                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     9 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     5 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     5 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                        
|*  3 |    TABLE ACCESS FULL    | T2   |     1 |     5 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"=150001)                                                                                                                                                                              
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         2                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  9jh4ms6ruztw2, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 611317447                                                                                                                                                                              
                                                                                                                                                                                                        
---------------------------------------------------------------------------------------------                                                                                                           
| Id  | Operation            | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
|   0 | SELECT STATEMENT     |      |       |       |    16 (100)|          |       |       |                                                                                                           
|   1 |  SORT AGGREGATE      |      |     1 |     4 |            |          |       |       |                                                                                                           
|   2 |   PARTITION RANGE ALL|      |     2 |     8 |    16   (0)| 00:00:01 |     1 |     2 |                                                                                                           
|*  3 |    TABLE ACCESS FULL | T2   |     2 |     8 |    16   (0)| 00:00:01 |     1 |     2 |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

20 rows selected.


 SUM(VAL2)                                                                                                                                                                                              
----------                                                                                                                                                                                              
  49995000                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  31pkfzpmx1b62, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                                                                                                                        
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|   2 |   TABLE ACCESS FULL| T1   |  9999 | 39996 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        

14 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9998                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  czjk2xd0vn20k, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 771265474                                                                                                                                                                              
                                                                                                                                                                                                        
--------------------------------------------------------------------------------------------------                                                                                                      
| Id  | Operation                 | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                      
--------------------------------------------------------------------------------------------------                                                                                                      
|   0 | SELECT STATEMENT          |      |       |       |    25 (100)|          |       |       |                                                                                                      
|   1 |  SORT AGGREGATE           |      |     1 |     5 |            |          |       |       |                                                                                                      
|   2 |   PARTITION RANGE ITERATOR|      |  1000 |  5000 |    16   (0)| 00:00:01 |     1 |   KEY |                                                                                                      
|*  3 |    TABLE ACCESS FULL      | T2   |  1000 |  5000 |    16   (0)| 00:00:01 |     1 |   KEY |                                                                                                      
|   4 |     SORT AGGREGATE        |      |     1 |     4 |            |          |       |       |                                                                                                      
|   5 |      TABLE ACCESS FULL    | T1   |  9999 | 39996 |     9   (0)| 00:00:01 |       |       |                                                                                                      
--------------------------------------------------------------------------------------------------                                                                                                      
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"<)                                                                                                                                                                                    
                                                                                                                                                                                                        

22 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
        49                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  ax2r0jyjs0hbb, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where                                                                                                                                 
val2<50                                                                                                                                                                                                 
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |    49 |   196 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL2"<50)                                                                                                                                                                                
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  7c65qbgku7can, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p2)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     9 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                                
|   3 |    TABLE ACCESS FULL    | T2   |  9999 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  221p0y74xg65x, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p1)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     9 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                                
|   3 |    TABLE ACCESS FULL    | T2   |  9999 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


49 rows updated.


98 rows updated.


49 rows updated.


49 rows updated.


Commit complete.


SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 N                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 N                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    VALID                           0 N                    N                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         

14 rows selected.


no rows selected

SQL> --
SQL> -- TRUNCATE TABLE/PARTITION
SQL> --
SQL> -- ## NOTE Accepted but might not implemented because T1 is not partitioned...
SQL> truncate table t1 deferred invalidation;

Table truncated.

SQL> alter table t2 truncate partition p1 deferred invalidation;

Table truncated.

SQL> set echo off
###  Truncate partition is fine-grained, but truncate table is not

SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    VALID                           0 N                    Y                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    VALID                           0 N                    Y                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    VALID                           0 N                    Y                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    VALID                           0 N                    Y                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 N                    Y                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    Y                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    Y                    N                                                                                         

14 rows selected.


no rows selected


Table dropped.


Table dropped.


Table created.


Table created.


9999 rows created.


9999 rows created.


9999 rows created.


Index created.


Index created.


PL/SQL procedure successfully completed.


PL/SQL procedure successfully completed.

Get rid of indexes...
SQL> drop index t1i;

Index dropped.

SQL> drop index t2i;

Index dropped.

SQL> set echo off

System altered.


  COUNT(*)                                                                                                                                                                                                                                                                                                  
----------                                                                                                                                                                                                                                                                                                  
         1                                                                                                                                                                                                                                                                                                  


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  cf016xd0knzrh, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  gvd4z9ba14uh3, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  1y9y6gg3r5sry, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     9 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     4 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     4 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                        
|*  3 |    TABLE ACCESS FULL    | T2   |     1 |     4 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         0                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  dcvq5bcm8yqm9, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1+150000                                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     9 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     5 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     5 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                        
|*  3 |    TABLE ACCESS FULL    | T2   |     1 |     5 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"=150001)                                                                                                                                                                              
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         2                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  9jh4ms6ruztw2, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 611317447                                                                                                                                                                              
                                                                                                                                                                                                        
---------------------------------------------------------------------------------------------                                                                                                           
| Id  | Operation            | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
|   0 | SELECT STATEMENT     |      |       |       |    16 (100)|          |       |       |                                                                                                           
|   1 |  SORT AGGREGATE      |      |     1 |     4 |            |          |       |       |                                                                                                           
|   2 |   PARTITION RANGE ALL|      |     2 |     8 |    16   (0)| 00:00:01 |     1 |     2 |                                                                                                           
|*  3 |    TABLE ACCESS FULL | T2   |     2 |     8 |    16   (0)| 00:00:01 |     1 |     2 |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

20 rows selected.


 SUM(VAL2)                                                                                                                                                                                              
----------                                                                                                                                                                                              
  49995000                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  31pkfzpmx1b62, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                                                                                                                        
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|   2 |   TABLE ACCESS FULL| T1   |  9999 | 39996 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        

14 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9998                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  czjk2xd0vn20k, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 771265474                                                                                                                                                                              
                                                                                                                                                                                                        
--------------------------------------------------------------------------------------------------                                                                                                      
| Id  | Operation                 | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                      
--------------------------------------------------------------------------------------------------                                                                                                      
|   0 | SELECT STATEMENT          |      |       |       |    25 (100)|          |       |       |                                                                                                      
|   1 |  SORT AGGREGATE           |      |     1 |     5 |            |          |       |       |                                                                                                      
|   2 |   PARTITION RANGE ITERATOR|      |  1000 |  5000 |    16   (0)| 00:00:01 |     1 |   KEY |                                                                                                      
|*  3 |    TABLE ACCESS FULL      | T2   |  1000 |  5000 |    16   (0)| 00:00:01 |     1 |   KEY |                                                                                                      
|   4 |     SORT AGGREGATE        |      |     1 |     4 |            |          |       |       |                                                                                                      
|   5 |      TABLE ACCESS FULL    | T1   |  9999 | 39996 |     9   (0)| 00:00:01 |       |       |                                                                                                      
--------------------------------------------------------------------------------------------------                                                                                                      
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"<)                                                                                                                                                                                    
                                                                                                                                                                                                        

22 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
        49                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  ax2r0jyjs0hbb, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where                                                                                                                                 
val2<50                                                                                                                                                                                                 
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |    49 |   196 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL2"<50)                                                                                                                                                                                
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  7c65qbgku7can, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p2)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     9 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                                
|   3 |    TABLE ACCESS FULL    | T2   |  9999 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  221p0y74xg65x, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p1)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     9 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                                
|   3 |    TABLE ACCESS FULL    | T2   |  9999 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


49 rows updated.


98 rows updated.


49 rows updated.


49 rows updated.


Commit complete.


SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 N                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 N                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    VALID                           0 N                    N                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         

14 rows selected.


no rows selected

SQL> --
SQL> -- MOVE TABLE/PARTITION
SQL> --
SQL> -- ## NOTE Accepted but might not implemented...
SQL> alter table t1 move deferred invalidation;

Table altered.

SQL> alter table t2 move partition p1 deferred invalidation;

Table altered.

SQL> set echo off
###  Truncate partition is fine-grained, but truncate table is not

SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    VALID                           0 N                    Y                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    VALID                           0 N                    Y                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    VALID                           0 N                    Y                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    VALID                           0 N                    Y                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 N                    Y                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    Y                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    Y                    N                                                                                         

14 rows selected.


no rows selected


Table dropped.


Table dropped.


Table created.


Table created.


9999 rows created.


9999 rows created.


9999 rows created.


Index created.


Index created.


PL/SQL procedure successfully completed.


PL/SQL procedure successfully completed.

Get rid of indexes...
SQL> drop index t1i;

Index dropped.

SQL> drop index t2i;

Index dropped.

SQL> set echo off

System altered.


  COUNT(*)                                                                                                                                                                                                                                                                                                  
----------                                                                                                                                                                                                                                                                                                  
         1                                                                                                                                                                                                                                                                                                  


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  cf016xd0knzrh, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  gvd4z9ba14uh3, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  1y9y6gg3r5sry, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     9 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     4 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     4 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                        
|*  3 |    TABLE ACCESS FULL    | T2   |     1 |     4 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         0                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  dcvq5bcm8yqm9, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1+150000                                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     9 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     5 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     5 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                        
|*  3 |    TABLE ACCESS FULL    | T2   |     1 |     5 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"=150001)                                                                                                                                                                              
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         2                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  9jh4ms6ruztw2, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 611317447                                                                                                                                                                              
                                                                                                                                                                                                        
---------------------------------------------------------------------------------------------                                                                                                           
| Id  | Operation            | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
|   0 | SELECT STATEMENT     |      |       |       |    16 (100)|          |       |       |                                                                                                           
|   1 |  SORT AGGREGATE      |      |     1 |     4 |            |          |       |       |                                                                                                           
|   2 |   PARTITION RANGE ALL|      |     2 |     8 |    16   (0)| 00:00:01 |     1 |     2 |                                                                                                           
|*  3 |    TABLE ACCESS FULL | T2   |     2 |     8 |    16   (0)| 00:00:01 |     1 |     2 |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

20 rows selected.


 SUM(VAL2)                                                                                                                                                                                              
----------                                                                                                                                                                                              
  49995000                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  31pkfzpmx1b62, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                                                                                                                        
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|   2 |   TABLE ACCESS FULL| T1   |  9999 | 39996 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        

14 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9998                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  czjk2xd0vn20k, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 771265474                                                                                                                                                                              
                                                                                                                                                                                                        
--------------------------------------------------------------------------------------------------                                                                                                      
| Id  | Operation                 | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                      
--------------------------------------------------------------------------------------------------                                                                                                      
|   0 | SELECT STATEMENT          |      |       |       |    25 (100)|          |       |       |                                                                                                      
|   1 |  SORT AGGREGATE           |      |     1 |     5 |            |          |       |       |                                                                                                      
|   2 |   PARTITION RANGE ITERATOR|      |  1000 |  5000 |    16   (0)| 00:00:01 |     1 |   KEY |                                                                                                      
|*  3 |    TABLE ACCESS FULL      | T2   |  1000 |  5000 |    16   (0)| 00:00:01 |     1 |   KEY |                                                                                                      
|   4 |     SORT AGGREGATE        |      |     1 |     4 |            |          |       |       |                                                                                                      
|   5 |      TABLE ACCESS FULL    | T1   |  9999 | 39996 |     9   (0)| 00:00:01 |       |       |                                                                                                      
--------------------------------------------------------------------------------------------------                                                                                                      
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"<)                                                                                                                                                                                    
                                                                                                                                                                                                        

22 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
        49                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  ax2r0jyjs0hbb, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where                                                                                                                                 
val2<50                                                                                                                                                                                                 
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |    49 |   196 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL2"<50)                                                                                                                                                                                
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  7c65qbgku7can, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p2)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     9 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                                
|   3 |    TABLE ACCESS FULL    | T2   |  9999 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  221p0y74xg65x, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p1)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     9 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                                
|   3 |    TABLE ACCESS FULL    | T2   |  9999 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


49 rows updated.


98 rows updated.


49 rows updated.


49 rows updated.


Commit complete.


SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 N                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 N                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    VALID                           0 N                    N                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         

14 rows selected.


no rows selected

SQL> --
SQL> -- MOVE TABLE/PARTITION
SQL> --
SQL> -- ## NOTE Accepted but might not be implemented...
SQL> alter table t1 move deferred invalidation;

Table altered.

SQL> alter table t2 move deferred invalidation;
alter table t2 move deferred invalidation
            *
ERROR at line 1:
ORA-14511: cannot perform operation on a partitioned object 


SQL> set echo off

SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         

14 rows selected.


no rows selected


Table dropped.


Table dropped.


Table created.


Table created.


9999 rows created.


9999 rows created.


9999 rows created.


Index created.


Index created.


PL/SQL procedure successfully completed.


PL/SQL procedure successfully completed.

Get rid of indexes...
SQL> drop index t1i;

Index dropped.

SQL> drop index t2i;

Index dropped.

SQL> set echo off

System altered.


  COUNT(*)                                                                                                                                                                                                                                                                                                  
----------                                                                                                                                                                                                                                                                                                  
         1                                                                                                                                                                                                                                                                                                  


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  cf016xd0knzrh, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  gvd4z9ba14uh3, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  1y9y6gg3r5sry, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     9 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     4 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     4 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                        
|*  3 |    TABLE ACCESS FULL    | T2   |     1 |     4 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         0                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  dcvq5bcm8yqm9, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1+150000                                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     9 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     5 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     5 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                        
|*  3 |    TABLE ACCESS FULL    | T2   |     1 |     5 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"=150001)                                                                                                                                                                              
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         2                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  9jh4ms6ruztw2, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 611317447                                                                                                                                                                              
                                                                                                                                                                                                        
---------------------------------------------------------------------------------------------                                                                                                           
| Id  | Operation            | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
|   0 | SELECT STATEMENT     |      |       |       |    16 (100)|          |       |       |                                                                                                           
|   1 |  SORT AGGREGATE      |      |     1 |     4 |            |          |       |       |                                                                                                           
|   2 |   PARTITION RANGE ALL|      |     2 |     8 |    16   (0)| 00:00:01 |     1 |     2 |                                                                                                           
|*  3 |    TABLE ACCESS FULL | T2   |     2 |     8 |    16   (0)| 00:00:01 |     1 |     2 |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

20 rows selected.


 SUM(VAL2)                                                                                                                                                                                              
----------                                                                                                                                                                                              
  49995000                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  31pkfzpmx1b62, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                                                                                                                        
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|   2 |   TABLE ACCESS FULL| T1   |  9999 | 39996 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        

14 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9998                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  czjk2xd0vn20k, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 771265474                                                                                                                                                                              
                                                                                                                                                                                                        
--------------------------------------------------------------------------------------------------                                                                                                      
| Id  | Operation                 | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                      
--------------------------------------------------------------------------------------------------                                                                                                      
|   0 | SELECT STATEMENT          |      |       |       |    25 (100)|          |       |       |                                                                                                      
|   1 |  SORT AGGREGATE           |      |     1 |     5 |            |          |       |       |                                                                                                      
|   2 |   PARTITION RANGE ITERATOR|      |  1000 |  5000 |    16   (0)| 00:00:01 |     1 |   KEY |                                                                                                      
|*  3 |    TABLE ACCESS FULL      | T2   |  1000 |  5000 |    16   (0)| 00:00:01 |     1 |   KEY |                                                                                                      
|   4 |     SORT AGGREGATE        |      |     1 |     4 |            |          |       |       |                                                                                                      
|   5 |      TABLE ACCESS FULL    | T1   |  9999 | 39996 |     9   (0)| 00:00:01 |       |       |                                                                                                      
--------------------------------------------------------------------------------------------------                                                                                                      
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"<)                                                                                                                                                                                    
                                                                                                                                                                                                        

22 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
        49                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  ax2r0jyjs0hbb, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where                                                                                                                                 
val2<50                                                                                                                                                                                                 
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |    49 |   196 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL2"<50)                                                                                                                                                                                
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  7c65qbgku7can, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p2)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     9 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                                
|   3 |    TABLE ACCESS FULL    | T2   |  9999 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  221p0y74xg65x, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p1)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     9 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                                
|   3 |    TABLE ACCESS FULL    | T2   |  9999 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


49 rows updated.


98 rows updated.


49 rows updated.


49 rows updated.


Commit complete.


SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 N                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 N                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    VALID                           0 N                    N                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         

14 rows selected.


no rows selected

SQL> --
SQL> -- TRUNCATE NON-PARTITIONED VS PARTITIONED TABLE
SQL> --
SQL> -- ## NOTE Accepted but might not implemented for non-partitioned table
SQL> truncate table t1 deferred invalidation;

Table truncated.

SQL> truncate table t2 deferred invalidation;

Table truncated.

SQL> set echo off
###  Truncate partition is fine-grained, but truncate table is not

SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    VALID                           0 N                    Y                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    VALID                           0 N                    Y                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    VALID                           0 N                    Y                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    VALID                           0 N                    Y                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 N                    Y                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    Y                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    Y                    N                                                                                         

14 rows selected.


no rows selected


Table dropped.


Table dropped.


Table created.


Table created.


9999 rows created.


9999 rows created.


9999 rows created.


Index created.


Index created.


PL/SQL procedure successfully completed.


PL/SQL procedure successfully completed.

Get rid of indexes...
SQL> drop index t1i;

Index dropped.

SQL> drop index t2i;

Index dropped.

SQL> set echo off

System altered.


  COUNT(*)                                                                                                                                                                                                                                                                                                  
----------                                                                                                                                                                                                                                                                                                  
         1                                                                                                                                                                                                                                                                                                  


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  cf016xd0knzrh, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  gvd4z9ba14uh3, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  1y9y6gg3r5sry, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     9 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     4 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     4 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                        
|*  3 |    TABLE ACCESS FULL    | T2   |     1 |     4 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         0                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  dcvq5bcm8yqm9, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1+150000                                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     9 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     5 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     5 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                        
|*  3 |    TABLE ACCESS FULL    | T2   |     1 |     5 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"=150001)                                                                                                                                                                              
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         2                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  9jh4ms6ruztw2, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 611317447                                                                                                                                                                              
                                                                                                                                                                                                        
---------------------------------------------------------------------------------------------                                                                                                           
| Id  | Operation            | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
|   0 | SELECT STATEMENT     |      |       |       |    16 (100)|          |       |       |                                                                                                           
|   1 |  SORT AGGREGATE      |      |     1 |     4 |            |          |       |       |                                                                                                           
|   2 |   PARTITION RANGE ALL|      |     2 |     8 |    16   (0)| 00:00:01 |     1 |     2 |                                                                                                           
|*  3 |    TABLE ACCESS FULL | T2   |     2 |     8 |    16   (0)| 00:00:01 |     1 |     2 |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

20 rows selected.


 SUM(VAL2)                                                                                                                                                                                              
----------                                                                                                                                                                                              
  49995000                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  31pkfzpmx1b62, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                                                                                                                        
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|   2 |   TABLE ACCESS FULL| T1   |  9999 | 39996 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        

14 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9998                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  czjk2xd0vn20k, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 771265474                                                                                                                                                                              
                                                                                                                                                                                                        
--------------------------------------------------------------------------------------------------                                                                                                      
| Id  | Operation                 | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                      
--------------------------------------------------------------------------------------------------                                                                                                      
|   0 | SELECT STATEMENT          |      |       |       |    25 (100)|          |       |       |                                                                                                      
|   1 |  SORT AGGREGATE           |      |     1 |     5 |            |          |       |       |                                                                                                      
|   2 |   PARTITION RANGE ITERATOR|      |  1000 |  5000 |    16   (0)| 00:00:01 |     1 |   KEY |                                                                                                      
|*  3 |    TABLE ACCESS FULL      | T2   |  1000 |  5000 |    16   (0)| 00:00:01 |     1 |   KEY |                                                                                                      
|   4 |     SORT AGGREGATE        |      |     1 |     4 |            |          |       |       |                                                                                                      
|   5 |      TABLE ACCESS FULL    | T1   |  9999 | 39996 |     9   (0)| 00:00:01 |       |       |                                                                                                      
--------------------------------------------------------------------------------------------------                                                                                                      
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"<)                                                                                                                                                                                    
                                                                                                                                                                                                        

22 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
        49                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  ax2r0jyjs0hbb, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where                                                                                                                                 
val2<50                                                                                                                                                                                                 
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |    49 |   196 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL2"<50)                                                                                                                                                                                
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  7c65qbgku7can, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p2)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     9 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                                
|   3 |    TABLE ACCESS FULL    | T2   |  9999 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  221p0y74xg65x, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p1)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     9 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                                
|   3 |    TABLE ACCESS FULL    | T2   |  9999 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


49 rows updated.


98 rows updated.


49 rows updated.


49 rows updated.


Commit complete.


SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 N                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 N                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    VALID                           0 N                    N                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         

14 rows selected.


no rows selected

SQL> --
SQL> -- ADD PARTITION
SQL> --
SQL> alter  table t2 add partition p3 values less than (300000) deferred invalidation;

Table altered.

SQL> set echo off

SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 N                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 N                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    VALID                           0 N                    Y                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    VALID                           0 N                    Y                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    VALID                           0 N                    Y                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 N                    Y                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         

14 rows selected.


no rows selected


Table dropped.


Table dropped.


Table created.


Table created.


9999 rows created.


9999 rows created.


9999 rows created.


Index created.


Index created.


PL/SQL procedure successfully completed.


PL/SQL procedure successfully completed.

Get rid of indexes...
SQL> drop index t1i;

Index dropped.

SQL> drop index t2i;

Index dropped.

SQL> alter  table t2 add partition p3 values less than (300000);

Table altered.

SQL> set echo off

System altered.


  COUNT(*)                                                                                                                                                                                                                                                                                                  
----------                                                                                                                                                                                                                                                                                                  
         1                                                                                                                                                                                                                                                                                                  


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  cf016xd0knzrh, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  gvd4z9ba14uh3, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  1y9y6gg3r5sry, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     8 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     4 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     4 |     8   (0)| 00:00:01 |     1 |     1 |                                                                                                        
|*  3 |    TABLE ACCESS FULL    | T2   |     1 |     4 |     8   (0)| 00:00:01 |     1 |     1 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         0                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  dcvq5bcm8yqm9, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1+150000                                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     9 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     5 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     5 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                        
|*  3 |    TABLE ACCESS FULL    | T2   |     1 |     5 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"=150001)                                                                                                                                                                              
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         2                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  9jh4ms6ruztw2, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 611317447                                                                                                                                                                              
                                                                                                                                                                                                        
---------------------------------------------------------------------------------------------                                                                                                           
| Id  | Operation            | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
|   0 | SELECT STATEMENT     |      |       |       |    15 (100)|          |       |       |                                                                                                           
|   1 |  SORT AGGREGATE      |      |     1 |     4 |            |          |       |       |                                                                                                           
|   2 |   PARTITION RANGE ALL|      |     2 |     8 |    15   (0)| 00:00:01 |     1 |     3 |                                                                                                           
|*  3 |    TABLE ACCESS FULL | T2   |     2 |     8 |    15   (0)| 00:00:01 |     1 |     3 |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

20 rows selected.


 SUM(VAL2)                                                                                                                                                                                              
----------                                                                                                                                                                                              
  49995000                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  31pkfzpmx1b62, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                                                                                                                        
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|   2 |   TABLE ACCESS FULL| T1   |  9999 | 39996 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        

14 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9998                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  czjk2xd0vn20k, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 771265474                                                                                                                                                                              
                                                                                                                                                                                                        
--------------------------------------------------------------------------------------------------                                                                                                      
| Id  | Operation                 | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                      
--------------------------------------------------------------------------------------------------                                                                                                      
|   0 | SELECT STATEMENT          |      |       |       |    25 (100)|          |       |       |                                                                                                      
|   1 |  SORT AGGREGATE           |      |     1 |     5 |            |          |       |       |                                                                                                      
|   2 |   PARTITION RANGE ITERATOR|      |  1000 |  5000 |    16   (0)| 00:00:01 |     1 |   KEY |                                                                                                      
|*  3 |    TABLE ACCESS FULL      | T2   |  1000 |  5000 |    16   (0)| 00:00:01 |     1 |   KEY |                                                                                                      
|   4 |     SORT AGGREGATE        |      |     1 |     4 |            |          |       |       |                                                                                                      
|   5 |      TABLE ACCESS FULL    | T1   |  9999 | 39996 |     9   (0)| 00:00:01 |       |       |                                                                                                      
--------------------------------------------------------------------------------------------------                                                                                                      
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"<)                                                                                                                                                                                    
                                                                                                                                                                                                        

22 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
        49                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  ax2r0jyjs0hbb, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where                                                                                                                                 
val2<50                                                                                                                                                                                                 
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |    49 |   196 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL2"<50)                                                                                                                                                                                
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  7c65qbgku7can, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p2)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     9 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                                
|   3 |    TABLE ACCESS FULL    | T2   |  9999 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  221p0y74xg65x, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p1)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     8 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     8   (0)| 00:00:01 |     1 |     1 |                                                                                                                
|   3 |    TABLE ACCESS FULL    | T2   |  9999 |     8   (0)| 00:00:01 |     1 |     1 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


49 rows updated.


98 rows updated.


49 rows updated.


49 rows updated.


Commit complete.


SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 N                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 N                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    VALID                           0 N                    N                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         

14 rows selected.


no rows selected

SQL> --
SQL> -- DROP PARTITION
SQL> --
SQL> alter table t2 drop partition p3 deferred invalidation;

Table altered.

SQL> set echo off

SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 N                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 N                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    VALID                           0 N                    Y                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 N                    Y                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    Y                    N                                                                                         

14 rows selected.


no rows selected


Table dropped.


Table dropped.


Table created.


Table created.


9999 rows created.


9999 rows created.


9999 rows created.


Index created.


Index created.


PL/SQL procedure successfully completed.


PL/SQL procedure successfully completed.

Get rid of indexes...
SQL> drop index t1i;

Index dropped.

SQL> drop index t2i;

Index dropped.

SQL> alter  table t2 add partition p3 values less than (300000);

Table altered.

SQL> set echo off

System altered.


  COUNT(*)                                                                                                                                                                                                                                                                                                  
----------                                                                                                                                                                                                                                                                                                  
         1                                                                                                                                                                                                                                                                                                  


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  cf016xd0knzrh, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  gvd4z9ba14uh3, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  1y9y6gg3r5sry, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     9 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     4 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     4 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                        
|*  3 |    TABLE ACCESS FULL    | T2   |     1 |     4 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         0                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  dcvq5bcm8yqm9, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1+150000                                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     9 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     5 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     5 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                        
|*  3 |    TABLE ACCESS FULL    | T2   |     1 |     5 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"=150001)                                                                                                                                                                              
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         2                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  9jh4ms6ruztw2, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 611317447                                                                                                                                                                              
                                                                                                                                                                                                        
---------------------------------------------------------------------------------------------                                                                                                           
| Id  | Operation            | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
|   0 | SELECT STATEMENT     |      |       |       |    16 (100)|          |       |       |                                                                                                           
|   1 |  SORT AGGREGATE      |      |     1 |     4 |            |          |       |       |                                                                                                           
|   2 |   PARTITION RANGE ALL|      |     2 |     8 |    16   (0)| 00:00:01 |     1 |     3 |                                                                                                           
|*  3 |    TABLE ACCESS FULL | T2   |     2 |     8 |    16   (0)| 00:00:01 |     1 |     3 |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

20 rows selected.


 SUM(VAL2)                                                                                                                                                                                              
----------                                                                                                                                                                                              
  49995000                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  31pkfzpmx1b62, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                                                                                                                        
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|   2 |   TABLE ACCESS FULL| T1   |  9999 | 39996 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        

14 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9998                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  czjk2xd0vn20k, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 771265474                                                                                                                                                                              
                                                                                                                                                                                                        
--------------------------------------------------------------------------------------------------                                                                                                      
| Id  | Operation                 | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                      
--------------------------------------------------------------------------------------------------                                                                                                      
|   0 | SELECT STATEMENT          |      |       |       |    25 (100)|          |       |       |                                                                                                      
|   1 |  SORT AGGREGATE           |      |     1 |     5 |            |          |       |       |                                                                                                      
|   2 |   PARTITION RANGE ITERATOR|      |  1000 |  5000 |    16   (0)| 00:00:01 |     1 |   KEY |                                                                                                      
|*  3 |    TABLE ACCESS FULL      | T2   |  1000 |  5000 |    16   (0)| 00:00:01 |     1 |   KEY |                                                                                                      
|   4 |     SORT AGGREGATE        |      |     1 |     4 |            |          |       |       |                                                                                                      
|   5 |      TABLE ACCESS FULL    | T1   |  9999 | 39996 |     9   (0)| 00:00:01 |       |       |                                                                                                      
--------------------------------------------------------------------------------------------------                                                                                                      
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"<)                                                                                                                                                                                    
                                                                                                                                                                                                        

22 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
        49                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  ax2r0jyjs0hbb, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where                                                                                                                                 
val2<50                                                                                                                                                                                                 
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |    49 |   196 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL2"<50)                                                                                                                                                                                
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  7c65qbgku7can, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p2)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     9 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                                
|   3 |    TABLE ACCESS FULL    | T2   |  9999 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  221p0y74xg65x, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p1)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     9 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                                
|   3 |    TABLE ACCESS FULL    | T2   |  9999 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


49 rows updated.


98 rows updated.


49 rows updated.


49 rows updated.


Commit complete.


SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 N                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 N                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    VALID                           0 N                    N                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         

14 rows selected.


no rows selected

SQL> --
SQL> -- SPLIT PARTITION
SQL> --
SQL> alter table t2 split partition p1 at (50000) into (partition p1,partition p1a) deferred invalidation;

Table altered.

SQL> set echo off

SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 N                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 N                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    VALID                           0 N                    Y                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 N                    Y                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         

14 rows selected.


no rows selected


Table dropped.


Table dropped.


Table created.


Table created.


9999 rows created.


9999 rows created.


9999 rows created.


Index created.


Index created.


PL/SQL procedure successfully completed.


PL/SQL procedure successfully completed.

Get rid of indexes...
SQL> drop index t1i;

Index dropped.

SQL> drop index t2i;

Index dropped.

SQL> alter  table t2 add partition p3 values less than (300000);

Table altered.

SQL> set echo off

System altered.


  COUNT(*)                                                                                                                                                                                                                                                                                                  
----------                                                                                                                                                                                                                                                                                                  
         1                                                                                                                                                                                                                                                                                                  


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  cf016xd0knzrh, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  gvd4z9ba14uh3, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  1y9y6gg3r5sry, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     9 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     4 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     4 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                        
|*  3 |    TABLE ACCESS FULL    | T2   |     1 |     4 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         0                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  dcvq5bcm8yqm9, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1+150000                                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     9 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     5 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     5 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                        
|*  3 |    TABLE ACCESS FULL    | T2   |     1 |     5 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"=150001)                                                                                                                                                                              
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         2                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  9jh4ms6ruztw2, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 611317447                                                                                                                                                                              
                                                                                                                                                                                                        
---------------------------------------------------------------------------------------------                                                                                                           
| Id  | Operation            | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
|   0 | SELECT STATEMENT     |      |       |       |    16 (100)|          |       |       |                                                                                                           
|   1 |  SORT AGGREGATE      |      |     1 |     4 |            |          |       |       |                                                                                                           
|   2 |   PARTITION RANGE ALL|      |     2 |     8 |    16   (0)| 00:00:01 |     1 |     3 |                                                                                                           
|*  3 |    TABLE ACCESS FULL | T2   |     2 |     8 |    16   (0)| 00:00:01 |     1 |     3 |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

20 rows selected.


 SUM(VAL2)                                                                                                                                                                                              
----------                                                                                                                                                                                              
  49995000                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  31pkfzpmx1b62, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                                                                                                                        
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|   2 |   TABLE ACCESS FULL| T1   |  9999 | 39996 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        

14 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9998                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  czjk2xd0vn20k, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 771265474                                                                                                                                                                              
                                                                                                                                                                                                        
--------------------------------------------------------------------------------------------------                                                                                                      
| Id  | Operation                 | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                      
--------------------------------------------------------------------------------------------------                                                                                                      
|   0 | SELECT STATEMENT          |      |       |       |    25 (100)|          |       |       |                                                                                                      
|   1 |  SORT AGGREGATE           |      |     1 |     5 |            |          |       |       |                                                                                                      
|   2 |   PARTITION RANGE ITERATOR|      |  1000 |  5000 |    16   (0)| 00:00:01 |     1 |   KEY |                                                                                                      
|*  3 |    TABLE ACCESS FULL      | T2   |  1000 |  5000 |    16   (0)| 00:00:01 |     1 |   KEY |                                                                                                      
|   4 |     SORT AGGREGATE        |      |     1 |     4 |            |          |       |       |                                                                                                      
|   5 |      TABLE ACCESS FULL    | T1   |  9999 | 39996 |     9   (0)| 00:00:01 |       |       |                                                                                                      
--------------------------------------------------------------------------------------------------                                                                                                      
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"<)                                                                                                                                                                                    
                                                                                                                                                                                                        

22 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
        49                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  ax2r0jyjs0hbb, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where                                                                                                                                 
val2<50                                                                                                                                                                                                 
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |    49 |   196 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL2"<50)                                                                                                                                                                                
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  7c65qbgku7can, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p2)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     9 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                                
|   3 |    TABLE ACCESS FULL    | T2   |  9999 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  221p0y74xg65x, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p1)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     9 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                                
|   3 |    TABLE ACCESS FULL    | T2   |  9999 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


49 rows updated.


98 rows updated.


49 rows updated.


49 rows updated.


Commit complete.


SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 N                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 N                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    VALID                           0 N                    N                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         

14 rows selected.


no rows selected

SQL> --
SQL> -- MERGE PARTITION
SQL> -- Note: hash-ADD, COALESCE should behave in same way - not tested here
SQL> --
SQL> alter table t2 merge partitions p2 to p3 into partition px deferred invalidation;

Table altered.

SQL> set echo off

SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 N                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 N                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    VALID                           0 N                    Y                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 N                    Y                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         

14 rows selected.


no rows selected


Table dropped.


Table dropped.


Table created.


Table created.


9999 rows created.


9999 rows created.


9999 rows created.


Index created.


Index created.


PL/SQL procedure successfully completed.


PL/SQL procedure successfully completed.

Get rid of indexes...
SQL> drop index t1i;

Index dropped.

SQL> drop index t2i;

Index dropped.

SQL> alter  table t2 add partition p3 values less than (300000);

Table altered.

SQL> set echo off

System altered.


  COUNT(*)                                                                                                                                                                                                                                                                                                  
----------                                                                                                                                                                                                                                                                                                  
         1                                                                                                                                                                                                                                                                                                  


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  cf016xd0knzrh, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  gvd4z9ba14uh3, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  1y9y6gg3r5sry, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     9 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     4 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     4 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                        
|*  3 |    TABLE ACCESS FULL    | T2   |     1 |     4 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         0                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  dcvq5bcm8yqm9, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1+150000                                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     9 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     5 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     5 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                        
|*  3 |    TABLE ACCESS FULL    | T2   |     1 |     5 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"=150001)                                                                                                                                                                              
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         2                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  9jh4ms6ruztw2, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 611317447                                                                                                                                                                              
                                                                                                                                                                                                        
---------------------------------------------------------------------------------------------                                                                                                           
| Id  | Operation            | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
|   0 | SELECT STATEMENT     |      |       |       |    16 (100)|          |       |       |                                                                                                           
|   1 |  SORT AGGREGATE      |      |     1 |     4 |            |          |       |       |                                                                                                           
|   2 |   PARTITION RANGE ALL|      |     2 |     8 |    16   (0)| 00:00:01 |     1 |     3 |                                                                                                           
|*  3 |    TABLE ACCESS FULL | T2   |     2 |     8 |    16   (0)| 00:00:01 |     1 |     3 |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

20 rows selected.


 SUM(VAL2)                                                                                                                                                                                              
----------                                                                                                                                                                                              
  49995000                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  31pkfzpmx1b62, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                                                                                                                        
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|   2 |   TABLE ACCESS FULL| T1   |  9999 | 39996 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        

14 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9998                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  czjk2xd0vn20k, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 771265474                                                                                                                                                                              
                                                                                                                                                                                                        
--------------------------------------------------------------------------------------------------                                                                                                      
| Id  | Operation                 | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                      
--------------------------------------------------------------------------------------------------                                                                                                      
|   0 | SELECT STATEMENT          |      |       |       |    25 (100)|          |       |       |                                                                                                      
|   1 |  SORT AGGREGATE           |      |     1 |     5 |            |          |       |       |                                                                                                      
|   2 |   PARTITION RANGE ITERATOR|      |  1000 |  5000 |    16   (0)| 00:00:01 |     1 |   KEY |                                                                                                      
|*  3 |    TABLE ACCESS FULL      | T2   |  1000 |  5000 |    16   (0)| 00:00:01 |     1 |   KEY |                                                                                                      
|   4 |     SORT AGGREGATE        |      |     1 |     4 |            |          |       |       |                                                                                                      
|   5 |      TABLE ACCESS FULL    | T1   |  9999 | 39996 |     9   (0)| 00:00:01 |       |       |                                                                                                      
--------------------------------------------------------------------------------------------------                                                                                                      
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"<)                                                                                                                                                                                    
                                                                                                                                                                                                        

22 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
        49                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  ax2r0jyjs0hbb, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where                                                                                                                                 
val2<50                                                                                                                                                                                                 
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |    49 |   196 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL2"<50)                                                                                                                                                                                
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  7c65qbgku7can, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p2)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     9 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                                
|   3 |    TABLE ACCESS FULL    | T2   |  9999 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  221p0y74xg65x, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p1)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     9 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                                
|   3 |    TABLE ACCESS FULL    | T2   |  9999 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


49 rows updated.


98 rows updated.


49 rows updated.


49 rows updated.


Commit complete.


SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 N                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 N                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    VALID                           0 N                    N                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         

14 rows selected.


no rows selected

SQL> --
SQL> -- SHRINK
SQL> --
SQL> -- Probably fails...
SQL> alter table t2 shrink space deferred invalidation;
alter table t2 shrink space deferred invalidation
                            *
ERROR at line 1:
ORA-10630: Illegal syntax specified with SHRINK clause 


SQL> set echo off

SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 N                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 N                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    VALID                           0 N                    N                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         

14 rows selected.


no rows selected


Table dropped.


Table dropped.


Table created.


Table created.


9999 rows created.


9999 rows created.


9999 rows created.


Index created.


Index created.


PL/SQL procedure successfully completed.


PL/SQL procedure successfully completed.

Get rid of indexes...
SQL> drop index t1i;

Index dropped.

SQL> drop index t2i;

Index dropped.

SQL> set echo off

System altered.


  COUNT(*)                                                                                                                                                                                                                                                                                                  
----------                                                                                                                                                                                                                                                                                                  
         1                                                                                                                                                                                                                                                                                                  


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  cf016xd0knzrh, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  gvd4z9ba14uh3, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  1y9y6gg3r5sry, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     9 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     4 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     4 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                        
|*  3 |    TABLE ACCESS FULL    | T2   |     1 |     4 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         0                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  dcvq5bcm8yqm9, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1+150000                                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     9 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     5 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     5 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                        
|*  3 |    TABLE ACCESS FULL    | T2   |     1 |     5 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"=150001)                                                                                                                                                                              
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         2                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  9jh4ms6ruztw2, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 611317447                                                                                                                                                                              
                                                                                                                                                                                                        
---------------------------------------------------------------------------------------------                                                                                                           
| Id  | Operation            | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
|   0 | SELECT STATEMENT     |      |       |       |    16 (100)|          |       |       |                                                                                                           
|   1 |  SORT AGGREGATE      |      |     1 |     4 |            |          |       |       |                                                                                                           
|   2 |   PARTITION RANGE ALL|      |     2 |     8 |    16   (0)| 00:00:01 |     1 |     2 |                                                                                                           
|*  3 |    TABLE ACCESS FULL | T2   |     2 |     8 |    16   (0)| 00:00:01 |     1 |     2 |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

20 rows selected.


 SUM(VAL2)                                                                                                                                                                                              
----------                                                                                                                                                                                              
  49995000                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  31pkfzpmx1b62, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                                                                                                                        
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|   2 |   TABLE ACCESS FULL| T1   |  9999 | 39996 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        

14 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9998                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  czjk2xd0vn20k, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 771265474                                                                                                                                                                              
                                                                                                                                                                                                        
--------------------------------------------------------------------------------------------------                                                                                                      
| Id  | Operation                 | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                      
--------------------------------------------------------------------------------------------------                                                                                                      
|   0 | SELECT STATEMENT          |      |       |       |    25 (100)|          |       |       |                                                                                                      
|   1 |  SORT AGGREGATE           |      |     1 |     5 |            |          |       |       |                                                                                                      
|   2 |   PARTITION RANGE ITERATOR|      |  1000 |  5000 |    16   (0)| 00:00:01 |     1 |   KEY |                                                                                                      
|*  3 |    TABLE ACCESS FULL      | T2   |  1000 |  5000 |    16   (0)| 00:00:01 |     1 |   KEY |                                                                                                      
|   4 |     SORT AGGREGATE        |      |     1 |     4 |            |          |       |       |                                                                                                      
|   5 |      TABLE ACCESS FULL    | T1   |  9999 | 39996 |     9   (0)| 00:00:01 |       |       |                                                                                                      
--------------------------------------------------------------------------------------------------                                                                                                      
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"<)                                                                                                                                                                                    
                                                                                                                                                                                                        

22 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
        49                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  ax2r0jyjs0hbb, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where                                                                                                                                 
val2<50                                                                                                                                                                                                 
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |    49 |   196 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL2"<50)                                                                                                                                                                                
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  7c65qbgku7can, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p2)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     9 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                                
|   3 |    TABLE ACCESS FULL    | T2   |  9999 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  221p0y74xg65x, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p1)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     9 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                                
|   3 |    TABLE ACCESS FULL    | T2   |  9999 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


49 rows updated.


98 rows updated.


49 rows updated.


49 rows updated.


Commit complete.


SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 N                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 N                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    VALID                           0 N                    N                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         

14 rows selected.


no rows selected

SQL> --
SQL> -- ADD CONSTRAINT
SQL> --
SQL> -- ## NOTE Accepted but might not be implemeted.
SQL> alter table t1 add constraint mypk1 primary key (id) deferred invalidation;

Table altered.

SQL> alter table t2 add constraint mypk2 primary key (id) deferred invalidation;

Table altered.

SQL> set echo off

SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         

14 rows selected.


no rows selected

SQL> -- ## NOTE Accepted but not not be implemeted.
SQL> alter table t1 drop constraint mypk1 deferred invalidation;

Table altered.

SQL> 
SQL> set echo off

Table dropped.


Table dropped.


Table created.


Table created.


9999 rows created.


9999 rows created.


9999 rows created.


Index created.


Index created.


PL/SQL procedure successfully completed.


PL/SQL procedure successfully completed.

rename
SQL> drop index t1i;

Index dropped.

SQL> drop index t2i;

Index dropped.

SQL> set echo off

System altered.


  COUNT(*)                                                                                                                                                                                                                                                                                                  
----------                                                                                                                                                                                                                                                                                                  
         1                                                                                                                                                                                                                                                                                                  


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  cf016xd0knzrh, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  gvd4z9ba14uh3, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  1y9y6gg3r5sry, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     8 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     4 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     4 |     8   (0)| 00:00:01 |     1 |     1 |                                                                                                        
|*  3 |    TABLE ACCESS FULL    | T2   |     1 |     4 |     8   (0)| 00:00:01 |     1 |     1 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         0                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  dcvq5bcm8yqm9, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1+150000                                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     9 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     5 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     5 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                        
|*  3 |    TABLE ACCESS FULL    | T2   |     1 |     5 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"=150001)                                                                                                                                                                              
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         2                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  9jh4ms6ruztw2, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 611317447                                                                                                                                                                              
                                                                                                                                                                                                        
---------------------------------------------------------------------------------------------                                                                                                           
| Id  | Operation            | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
|   0 | SELECT STATEMENT     |      |       |       |    15 (100)|          |       |       |                                                                                                           
|   1 |  SORT AGGREGATE      |      |     1 |     4 |            |          |       |       |                                                                                                           
|   2 |   PARTITION RANGE ALL|      |     2 |     8 |    15   (0)| 00:00:01 |     1 |     2 |                                                                                                           
|*  3 |    TABLE ACCESS FULL | T2   |     2 |     8 |    15   (0)| 00:00:01 |     1 |     2 |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

20 rows selected.


 SUM(VAL2)                                                                                                                                                                                              
----------                                                                                                                                                                                              
  49995000                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  31pkfzpmx1b62, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                                                                                                                        
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|   2 |   TABLE ACCESS FULL| T1   |  9999 | 39996 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        

14 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9998                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  czjk2xd0vn20k, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 771265474                                                                                                                                                                              
                                                                                                                                                                                                        
--------------------------------------------------------------------------------------------------                                                                                                      
| Id  | Operation                 | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                      
--------------------------------------------------------------------------------------------------                                                                                                      
|   0 | SELECT STATEMENT          |      |       |       |    24 (100)|          |       |       |                                                                                                      
|   1 |  SORT AGGREGATE           |      |     1 |     5 |            |          |       |       |                                                                                                      
|   2 |   PARTITION RANGE ITERATOR|      |  1000 |  5000 |    15   (0)| 00:00:01 |     1 |   KEY |                                                                                                      
|*  3 |    TABLE ACCESS FULL      | T2   |  1000 |  5000 |    15   (0)| 00:00:01 |     1 |   KEY |                                                                                                      
|   4 |     SORT AGGREGATE        |      |     1 |     4 |            |          |       |       |                                                                                                      
|   5 |      TABLE ACCESS FULL    | T1   |  9999 | 39996 |     9   (0)| 00:00:01 |       |       |                                                                                                      
--------------------------------------------------------------------------------------------------                                                                                                      
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"<)                                                                                                                                                                                    
                                                                                                                                                                                                        

22 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
        49                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  ax2r0jyjs0hbb, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where                                                                                                                                 
val2<50                                                                                                                                                                                                 
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |    49 |   196 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL2"<50)                                                                                                                                                                                
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  7c65qbgku7can, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p2)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     9 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                                
|   3 |    TABLE ACCESS FULL    | T2   |  9999 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  221p0y74xg65x, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p1)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     8 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     8   (0)| 00:00:01 |     1 |     1 |                                                                                                                
|   3 |    TABLE ACCESS FULL    | T2   |  9999 |     8   (0)| 00:00:01 |     1 |     1 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


49 rows updated.


98 rows updated.


49 rows updated.


49 rows updated.


Commit complete.


SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 N                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 N                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    VALID                           0 N                    N                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         

14 rows selected.


no rows selected

SQL> alter table t2 rename partition p2 to p2x deferred invalidation;
alter table t2 rename partition p2 to p2x deferred invalidation
                                          *
ERROR at line 1:
ORA-14048: a partition maintenance operation may not be combined with other operations 


SQL> set echo off

SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 N                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 N                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    VALID                           0 N                    N                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         

14 rows selected.


no rows selected

SQL> 
SQL> @tab
SQL> drop table t1;

Table dropped.

SQL> drop table t2;

Table dropped.

SQL> 
SQL> create table t1 (id number(10) not null, val1 number(10) not null, val2 number(10) not null);

Table created.

SQL> 
SQL> create table t2 (id number(10) not null, val1 number(10) not null, val2 number(10) not null)
  2  partition by range (id) (
  3    partition p1 values less than (100000)
  4  , partition p2 values less than (200000)
  5  )
  6  /

Table created.

SQL> 
SQL> insert into t1 select rownum,rownum,rownum from (
  2  select 1
  3  from dual connect by rownum < 10000);

9999 rows created.

SQL> 
SQL> insert into t2 select rownum,rownum,rownum from (
  2  select 1
  3  from dual connect by rownum < 10000);

9999 rows created.

SQL> 
SQL> insert into t2 select rownum+100000,rownum,rownum from (
  2  select 1
  3  from dual connect by rownum < 10000);

9999 rows created.

SQL> 
SQL> 
SQL> create index t1i on t1 (id);

Index created.

SQL> create index t2i on t2 (id) local (
  2  partition p1i,
  3  partition p2i);

Index created.

SQL> 
SQL> exec dbms_stats.gather_table_stats(ownname=>user,tabname=>'t1');

PL/SQL procedure successfully completed.

SQL> exec dbms_stats.gather_table_stats(ownname=>user,tabname=>'t2');

PL/SQL procedure successfully completed.

SQL> prompt rename
rename
SQL> set echo on
SQL> drop index t1i;

Index dropped.

SQL> drop index t2i;

Index dropped.

SQL> set echo off

System altered.


  COUNT(*)                                                                                                                                                                                                                                                                                                  
----------                                                                                                                                                                                                                                                                                                  
         1                                                                                                                                                                                                                                                                                                  


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  cf016xd0knzrh, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  gvd4z9ba14uh3, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  1y9y6gg3r5sry, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     9 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     4 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     4 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                        
|*  3 |    TABLE ACCESS FULL    | T2   |     1 |     4 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         0                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  dcvq5bcm8yqm9, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1+150000                                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     9 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     5 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     5 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                        
|*  3 |    TABLE ACCESS FULL    | T2   |     1 |     5 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"=150001)                                                                                                                                                                              
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         2                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  9jh4ms6ruztw2, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 611317447                                                                                                                                                                              
                                                                                                                                                                                                        
---------------------------------------------------------------------------------------------                                                                                                           
| Id  | Operation            | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
|   0 | SELECT STATEMENT     |      |       |       |    16 (100)|          |       |       |                                                                                                           
|   1 |  SORT AGGREGATE      |      |     1 |     4 |            |          |       |       |                                                                                                           
|   2 |   PARTITION RANGE ALL|      |     2 |     8 |    16   (0)| 00:00:01 |     1 |     2 |                                                                                                           
|*  3 |    TABLE ACCESS FULL | T2   |     2 |     8 |    16   (0)| 00:00:01 |     1 |     2 |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

20 rows selected.


 SUM(VAL2)                                                                                                                                                                                              
----------                                                                                                                                                                                              
  49995000                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  31pkfzpmx1b62, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                                                                                                                        
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|   2 |   TABLE ACCESS FULL| T1   |  9999 | 39996 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        

14 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9998                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  czjk2xd0vn20k, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 771265474                                                                                                                                                                              
                                                                                                                                                                                                        
--------------------------------------------------------------------------------------------------                                                                                                      
| Id  | Operation                 | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                      
--------------------------------------------------------------------------------------------------                                                                                                      
|   0 | SELECT STATEMENT          |      |       |       |    25 (100)|          |       |       |                                                                                                      
|   1 |  SORT AGGREGATE           |      |     1 |     5 |            |          |       |       |                                                                                                      
|   2 |   PARTITION RANGE ITERATOR|      |  1000 |  5000 |    16   (0)| 00:00:01 |     1 |   KEY |                                                                                                      
|*  3 |    TABLE ACCESS FULL      | T2   |  1000 |  5000 |    16   (0)| 00:00:01 |     1 |   KEY |                                                                                                      
|   4 |     SORT AGGREGATE        |      |     1 |     4 |            |          |       |       |                                                                                                      
|   5 |      TABLE ACCESS FULL    | T1   |  9999 | 39996 |     9   (0)| 00:00:01 |       |       |                                                                                                      
--------------------------------------------------------------------------------------------------                                                                                                      
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"<)                                                                                                                                                                                    
                                                                                                                                                                                                        

22 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
        49                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  ax2r0jyjs0hbb, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where                                                                                                                                 
val2<50                                                                                                                                                                                                 
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |    49 |   196 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL2"<50)                                                                                                                                                                                
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  7c65qbgku7can, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p2)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     9 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                                
|   3 |    TABLE ACCESS FULL    | T2   |  9999 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  221p0y74xg65x, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p1)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     9 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                                
|   3 |    TABLE ACCESS FULL    | T2   |  9999 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


49 rows updated.


98 rows updated.


49 rows updated.


49 rows updated.


Commit complete.


SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 N                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 N                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    VALID                           0 N                    N                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         

14 rows selected.


no rows selected

SQL> alter table t2 modify partition p2 read only deferred invalidation;

Table altered.

SQL> set echo off

SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 N                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 N                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    VALID                           0 N                    N                    Y                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    VALID                           0 N                    N                    Y                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    VALID                           0 N                    N                    Y                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    VALID                           0 N                    N                    Y                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    VALID                           0 N                    N                    Y                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    Y                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    Y                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    Y                    N                                                                                         

14 rows selected.


no rows selected

SQL> 
SQL> @tab
SQL> drop table t1;

Table dropped.

SQL> drop table t2;

Table dropped.

SQL> 
SQL> create table t1 (id number(10) not null, val1 number(10) not null, val2 number(10) not null);

Table created.

SQL> 
SQL> create table t2 (id number(10) not null, val1 number(10) not null, val2 number(10) not null)
  2  partition by range (id) (
  3    partition p1 values less than (100000)
  4  , partition p2 values less than (200000)
  5  )
  6  /

Table created.

SQL> 
SQL> insert into t1 select rownum,rownum,rownum from (
  2  select 1
  3  from dual connect by rownum < 10000);

9999 rows created.

SQL> 
SQL> insert into t2 select rownum,rownum,rownum from (
  2  select 1
  3  from dual connect by rownum < 10000);

9999 rows created.

SQL> 
SQL> insert into t2 select rownum+100000,rownum,rownum from (
  2  select 1
  3  from dual connect by rownum < 10000);

9999 rows created.

SQL> 
SQL> 
SQL> create index t1i on t1 (id);

Index created.

SQL> create index t2i on t2 (id) local (
  2  partition p1i,
  3  partition p2i);

Index created.

SQL> 
SQL> exec dbms_stats.gather_table_stats(ownname=>user,tabname=>'t1');

PL/SQL procedure successfully completed.

SQL> exec dbms_stats.gather_table_stats(ownname=>user,tabname=>'t2');

PL/SQL procedure successfully completed.

SQL> prompt rename
rename
SQL> set echo on
SQL> drop index t1i;

Index dropped.

SQL> drop index t2i;

Index dropped.

SQL> set echo off

System altered.


  COUNT(*)                                                                                                                                                                                                                                                                                                  
----------                                                                                                                                                                                                                                                                                                  
         1                                                                                                                                                                                                                                                                                                  


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  cf016xd0knzrh, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  gvd4z9ba14uh3, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  1y9y6gg3r5sry, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     9 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     4 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     4 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                        
|*  3 |    TABLE ACCESS FULL    | T2   |     1 |     4 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         0                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  dcvq5bcm8yqm9, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1+150000                                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     9 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     5 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     5 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                        
|*  3 |    TABLE ACCESS FULL    | T2   |     1 |     5 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"=150001)                                                                                                                                                                              
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         2                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  9jh4ms6ruztw2, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 611317447                                                                                                                                                                              
                                                                                                                                                                                                        
---------------------------------------------------------------------------------------------                                                                                                           
| Id  | Operation            | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
|   0 | SELECT STATEMENT     |      |       |       |    16 (100)|          |       |       |                                                                                                           
|   1 |  SORT AGGREGATE      |      |     1 |     4 |            |          |       |       |                                                                                                           
|   2 |   PARTITION RANGE ALL|      |     2 |     8 |    16   (0)| 00:00:01 |     1 |     2 |                                                                                                           
|*  3 |    TABLE ACCESS FULL | T2   |     2 |     8 |    16   (0)| 00:00:01 |     1 |     2 |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

20 rows selected.


 SUM(VAL2)                                                                                                                                                                                              
----------                                                                                                                                                                                              
  49995000                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  31pkfzpmx1b62, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                                                                                                                        
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|   2 |   TABLE ACCESS FULL| T1   |  9999 | 39996 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        

14 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9998                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  czjk2xd0vn20k, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 771265474                                                                                                                                                                              
                                                                                                                                                                                                        
--------------------------------------------------------------------------------------------------                                                                                                      
| Id  | Operation                 | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                      
--------------------------------------------------------------------------------------------------                                                                                                      
|   0 | SELECT STATEMENT          |      |       |       |    25 (100)|          |       |       |                                                                                                      
|   1 |  SORT AGGREGATE           |      |     1 |     5 |            |          |       |       |                                                                                                      
|   2 |   PARTITION RANGE ITERATOR|      |  1000 |  5000 |    16   (0)| 00:00:01 |     1 |   KEY |                                                                                                      
|*  3 |    TABLE ACCESS FULL      | T2   |  1000 |  5000 |    16   (0)| 00:00:01 |     1 |   KEY |                                                                                                      
|   4 |     SORT AGGREGATE        |      |     1 |     4 |            |          |       |       |                                                                                                      
|   5 |      TABLE ACCESS FULL    | T1   |  9999 | 39996 |     9   (0)| 00:00:01 |       |       |                                                                                                      
--------------------------------------------------------------------------------------------------                                                                                                      
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"<)                                                                                                                                                                                    
                                                                                                                                                                                                        

22 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
        49                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  ax2r0jyjs0hbb, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where                                                                                                                                 
val2<50                                                                                                                                                                                                 
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |    49 |   196 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL2"<50)                                                                                                                                                                                
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  7c65qbgku7can, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p2)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     9 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                                
|   3 |    TABLE ACCESS FULL    | T2   |  9999 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  221p0y74xg65x, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p1)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     9 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                                
|   3 |    TABLE ACCESS FULL    | T2   |  9999 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


49 rows updated.


98 rows updated.


49 rows updated.


49 rows updated.


Commit complete.


SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 N                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 N                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    VALID                           0 N                    N                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         

14 rows selected.


no rows selected

SQL> alter table t1 parallel 4 deferred invalidation;

Table altered.

SQL> alter table t2 parallel 4 deferred invalidation;

Table altered.

SQL> set echo off

SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 Y                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 Y                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    VALID                           0 Y                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 Y                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    VALID                           0 Y                    N                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    VALID                           0 Y                    N                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    VALID                           0 Y                    N                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    VALID                           0 Y                    N                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    VALID                           0 Y                    N                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 Y                    N                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 Y                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 Y                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 Y                    N                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 Y                    N                    N                                                                                         

14 rows selected.


no rows selected

SQL> 
SQL> @tab
SQL> drop table t1;

Table dropped.

SQL> drop table t2;

Table dropped.

SQL> 
SQL> create table t1 (id number(10) not null, val1 number(10) not null, val2 number(10) not null);

Table created.

SQL> 
SQL> create table t2 (id number(10) not null, val1 number(10) not null, val2 number(10) not null)
  2  partition by range (id) (
  3    partition p1 values less than (100000)
  4  , partition p2 values less than (200000)
  5  )
  6  /

Table created.

SQL> 
SQL> insert into t1 select rownum,rownum,rownum from (
  2  select 1
  3  from dual connect by rownum < 10000);

9999 rows created.

SQL> 
SQL> insert into t2 select rownum,rownum,rownum from (
  2  select 1
  3  from dual connect by rownum < 10000);

9999 rows created.

SQL> 
SQL> insert into t2 select rownum+100000,rownum,rownum from (
  2  select 1
  3  from dual connect by rownum < 10000);

9999 rows created.

SQL> 
SQL> 
SQL> create index t1i on t1 (id);

Index created.

SQL> create index t2i on t2 (id) local (
  2  partition p1i,
  3  partition p2i);

Index created.

SQL> 
SQL> exec dbms_stats.gather_table_stats(ownname=>user,tabname=>'t1');

PL/SQL procedure successfully completed.

SQL> exec dbms_stats.gather_table_stats(ownname=>user,tabname=>'t2');

PL/SQL procedure successfully completed.

SQL> prompt rename
rename
SQL> set echo on
SQL> drop index t1i;

Index dropped.

SQL> drop index t2i;

Index dropped.

SQL> set echo off

System altered.


  COUNT(*)                                                                                                                                                                                                                                                                                                  
----------                                                                                                                                                                                                                                                                                                  
         1                                                                                                                                                                                                                                                                                                  


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  cf016xd0knzrh, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  gvd4z9ba14uh3, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  1y9y6gg3r5sry, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     9 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     4 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     4 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                        
|*  3 |    TABLE ACCESS FULL    | T2   |     1 |     4 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         0                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  dcvq5bcm8yqm9, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1+150000                                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     9 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     5 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     5 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                        
|*  3 |    TABLE ACCESS FULL    | T2   |     1 |     5 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"=150001)                                                                                                                                                                              
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         2                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  9jh4ms6ruztw2, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 611317447                                                                                                                                                                              
                                                                                                                                                                                                        
---------------------------------------------------------------------------------------------                                                                                                           
| Id  | Operation            | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
|   0 | SELECT STATEMENT     |      |       |       |    16 (100)|          |       |       |                                                                                                           
|   1 |  SORT AGGREGATE      |      |     1 |     4 |            |          |       |       |                                                                                                           
|   2 |   PARTITION RANGE ALL|      |     2 |     8 |    16   (0)| 00:00:01 |     1 |     2 |                                                                                                           
|*  3 |    TABLE ACCESS FULL | T2   |     2 |     8 |    16   (0)| 00:00:01 |     1 |     2 |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

20 rows selected.


 SUM(VAL2)                                                                                                                                                                                              
----------                                                                                                                                                                                              
  49995000                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  31pkfzpmx1b62, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                                                                                                                        
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|   2 |   TABLE ACCESS FULL| T1   |  9999 | 39996 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        

14 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9998                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  czjk2xd0vn20k, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 771265474                                                                                                                                                                              
                                                                                                                                                                                                        
--------------------------------------------------------------------------------------------------                                                                                                      
| Id  | Operation                 | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                      
--------------------------------------------------------------------------------------------------                                                                                                      
|   0 | SELECT STATEMENT          |      |       |       |    25 (100)|          |       |       |                                                                                                      
|   1 |  SORT AGGREGATE           |      |     1 |     5 |            |          |       |       |                                                                                                      
|   2 |   PARTITION RANGE ITERATOR|      |  1000 |  5000 |    16   (0)| 00:00:01 |     1 |   KEY |                                                                                                      
|*  3 |    TABLE ACCESS FULL      | T2   |  1000 |  5000 |    16   (0)| 00:00:01 |     1 |   KEY |                                                                                                      
|   4 |     SORT AGGREGATE        |      |     1 |     4 |            |          |       |       |                                                                                                      
|   5 |      TABLE ACCESS FULL    | T1   |  9999 | 39996 |     9   (0)| 00:00:01 |       |       |                                                                                                      
--------------------------------------------------------------------------------------------------                                                                                                      
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"<)                                                                                                                                                                                    
                                                                                                                                                                                                        

22 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
        49                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  ax2r0jyjs0hbb, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where                                                                                                                                 
val2<50                                                                                                                                                                                                 
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |    49 |   196 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL2"<50)                                                                                                                                                                                
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  7c65qbgku7can, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p2)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     9 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                                
|   3 |    TABLE ACCESS FULL    | T2   |  9999 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  221p0y74xg65x, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p1)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     9 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                                
|   3 |    TABLE ACCESS FULL    | T2   |  9999 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


49 rows updated.


98 rows updated.


49 rows updated.


49 rows updated.


Commit complete.


SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 N                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 N                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    VALID                           0 N                    N                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         

14 rows selected.


no rows selected

SQL> alter table t1 read only deferred invalidation;

Table altered.

SQL> alter table t2 read only deferred invalidation;

Table altered.

SQL> set echo off

SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 N                    N                    Y                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 N                    N                    Y                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    VALID                           0 N                    N                    Y                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    Y                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    VALID                           0 N                    N                    Y                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    VALID                           0 N                    N                    Y                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    VALID                           0 N                    N                    Y                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    VALID                           0 N                    N                    Y                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    VALID                           0 N                    N                    Y                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    Y                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    INVALID_UNAUTH                  1 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    Y                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    Y                    N                                                                                         

14 rows selected.


no rows selected

SQL> 
SQL> @tab
SQL> drop table t1;

Table dropped.

SQL> drop table t2;

Table dropped.

SQL> 
SQL> create table t1 (id number(10) not null, val1 number(10) not null, val2 number(10) not null);

Table created.

SQL> 
SQL> create table t2 (id number(10) not null, val1 number(10) not null, val2 number(10) not null)
  2  partition by range (id) (
  3    partition p1 values less than (100000)
  4  , partition p2 values less than (200000)
  5  )
  6  /

Table created.

SQL> 
SQL> insert into t1 select rownum,rownum,rownum from (
  2  select 1
  3  from dual connect by rownum < 10000);

9999 rows created.

SQL> 
SQL> insert into t2 select rownum,rownum,rownum from (
  2  select 1
  3  from dual connect by rownum < 10000);

9999 rows created.

SQL> 
SQL> insert into t2 select rownum+100000,rownum,rownum from (
  2  select 1
  3  from dual connect by rownum < 10000);

9999 rows created.

SQL> 
SQL> 
SQL> create index t1i on t1 (id);

Index created.

SQL> create index t2i on t2 (id) local (
  2  partition p1i,
  3  partition p2i);

Index created.

SQL> 
SQL> exec dbms_stats.gather_table_stats(ownname=>user,tabname=>'t1');

PL/SQL procedure successfully completed.

SQL> exec dbms_stats.gather_table_stats(ownname=>user,tabname=>'t2');

PL/SQL procedure successfully completed.

SQL> prompt rename
rename
SQL> set echo on
SQL> drop index t1i;

Index dropped.

SQL> drop index t2i;

Index dropped.

SQL> set echo off

System altered.


  COUNT(*)                                                                                                                                                                                                                                                                                                  
----------                                                                                                                                                                                                                                                                                                  
         1                                                                                                                                                                                                                                                                                                  


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  cf016xd0knzrh, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  gvd4z9ba14uh3, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t1 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |     1 |     4 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

19 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         1                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  1y9y6gg3r5sry, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1                                                                                                                                                       
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     9 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     4 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     4 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                        
|*  3 |    TABLE ACCESS FULL    | T2   |     1 |     4 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"=1)                                                                                                                                                                                   
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         0                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  dcvq5bcm8yqm9, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id = 1+150000                                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
| Id  | Operation               | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
|   0 | SELECT STATEMENT        |      |       |       |     9 (100)|          |       |       |                                                                                                        
|   1 |  SORT AGGREGATE         |      |     1 |     5 |            |          |       |       |                                                                                                        
|   2 |   PARTITION RANGE SINGLE|      |     1 |     5 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                        
|*  3 |    TABLE ACCESS FULL    | T2   |     1 |     5 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                        
------------------------------------------------------------------------------------------------                                                                                                        
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"=150001)                                                                                                                                                                              
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
         2                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  9jh4ms6ruztw2, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where val1 = 1                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 611317447                                                                                                                                                                              
                                                                                                                                                                                                        
---------------------------------------------------------------------------------------------                                                                                                           
| Id  | Operation            | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
|   0 | SELECT STATEMENT     |      |       |       |    16 (100)|          |       |       |                                                                                                           
|   1 |  SORT AGGREGATE      |      |     1 |     4 |            |          |       |       |                                                                                                           
|   2 |   PARTITION RANGE ALL|      |     2 |     8 |    16   (0)| 00:00:01 |     1 |     2 |                                                                                                           
|*  3 |    TABLE ACCESS FULL | T2   |     2 |     8 |    16   (0)| 00:00:01 |     1 |     2 |                                                                                                           
---------------------------------------------------------------------------------------------                                                                                                           
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("VAL1"=1)                                                                                                                                                                                 
                                                                                                                                                                                                        

20 rows selected.


 SUM(VAL2)                                                                                                                                                                                              
----------                                                                                                                                                                                              
  49995000                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  31pkfzpmx1b62, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                                                                                                                        
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|   2 |   TABLE ACCESS FULL| T1   |  9999 | 39996 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        

14 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9998                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  czjk2xd0vn20k, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                                                                                                                                
                                                                                                                                                                                                        
Plan hash value: 771265474                                                                                                                                                                              
                                                                                                                                                                                                        
--------------------------------------------------------------------------------------------------                                                                                                      
| Id  | Operation                 | Name | Rows  | Bytes | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                      
--------------------------------------------------------------------------------------------------                                                                                                      
|   0 | SELECT STATEMENT          |      |       |       |    25 (100)|          |       |       |                                                                                                      
|   1 |  SORT AGGREGATE           |      |     1 |     5 |            |          |       |       |                                                                                                      
|   2 |   PARTITION RANGE ITERATOR|      |  1000 |  5000 |    16   (0)| 00:00:01 |     1 |   KEY |                                                                                                      
|*  3 |    TABLE ACCESS FULL      | T2   |  1000 |  5000 |    16   (0)| 00:00:01 |     1 |   KEY |                                                                                                      
|   4 |     SORT AGGREGATE        |      |     1 |     4 |            |          |       |       |                                                                                                      
|   5 |      TABLE ACCESS FULL    | T1   |  9999 | 39996 |     9   (0)| 00:00:01 |       |       |                                                                                                      
--------------------------------------------------------------------------------------------------                                                                                                      
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   3 - filter("ID"<)                                                                                                                                                                                    
                                                                                                                                                                                                        

22 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
        49                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  ax2r0jyjs0hbb, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where                                                                                                                                 
val2<50                                                                                                                                                                                                 
                                                                                                                                                                                                        
Plan hash value: 3724264953                                                                                                                                                                             
                                                                                                                                                                                                        
---------------------------------------------------------------------------                                                                                                                             
| Id  | Operation          | Name | Rows  | Bytes | Cost (%CPU)| Time     |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
|   0 | SELECT STATEMENT   |      |       |       |     9 (100)|          |                                                                                                                             
|   1 |  SORT AGGREGATE    |      |     1 |     4 |            |          |                                                                                                                             
|*  2 |   TABLE ACCESS FULL| T1   |    49 |   196 |     9   (0)| 00:00:01 |                                                                                                                             
---------------------------------------------------------------------------                                                                                                                             
                                                                                                                                                                                                        
Predicate Information (identified by operation id):                                                                                                                                                     
---------------------------------------------------                                                                                                                                                     
                                                                                                                                                                                                        
   2 - filter("VAL2"<50)                                                                                                                                                                                
                                                                                                                                                                                                        

20 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  7c65qbgku7can, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p2)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     9 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                                
|   3 |    TABLE ACCESS FULL    | T2   |  9999 |     9   (0)| 00:00:01 |     2 |     2 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


  COUNT(*)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      9999                                                                                                                                                                                              


PLAN_TABLE_OUTPUT                                                                                                                                                                                       
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------                    
SQL_ID  221p0y74xg65x, child number 0                                                                                                                                                                   
-------------------------------------                                                                                                                                                                   
select /* TESTFG */ count(*) from t2 partition (p1)                                                                                                                                                     
                                                                                                                                                                                                        
Plan hash value: 2457353553                                                                                                                                                                             
                                                                                                                                                                                                        
----------------------------------------------------------------------------------------                                                                                                                
| Id  | Operation               | Name | Rows  | Cost (%CPU)| Time     | Pstart| Pstop |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
|   0 | SELECT STATEMENT        |      |       |     9 (100)|          |       |       |                                                                                                                
|   1 |  SORT AGGREGATE         |      |     1 |            |          |       |       |                                                                                                                
|   2 |   PARTITION RANGE SINGLE|      |  9999 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                                
|   3 |    TABLE ACCESS FULL    | T2   |  9999 |     9   (0)| 00:00:01 |     1 |     1 |                                                                                                                
----------------------------------------------------------------------------------------                                                                                                                
                                                                                                                                                                                                        

15 rows selected.


49 rows updated.


98 rows updated.


49 rows updated.


49 rows updated.


Commit complete.


SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 N                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 N                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    VALID                           0 N                    N                    N                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         

14 rows selected.


no rows selected

SQL> alter table t2 modify default attributes tablespace system deferred invalidation;

Table altered.

SQL> set echo off

SQL_ID        SQL_TEXT                                                                              CHILD_NUMBER IS_SHAREABLE         OBJECT_STATUS       INVALIDATIONS IS_ROLLING_INVALID   IS_ROLLING_REFRESH_I DDL_NO_INVALIDATE                                                                         
------------- ------------------------------------------------------------------------------------- ------------ -------------------- ------------------- ------------- -------------------- -------------------- --------------------                                                                      
31pkfzpmx1b62 select /* TESTFG */ /*+ INDEX_FFS(t new1) */ sum(val2) from t1 t                                 0 Y                    VALID                           0 N                    N                    N                                                                                         
ax2r0jyjs0hbb select /* TESTFG */ /*+ USE_INVISIBLE_INDEXES */ count(*) from t1 where val2<50                  0 Y                    VALID                           0 N                    N                    N                                                                                         
cf016xd0knzrh select /* TESTFG */ count(*) from t1 where id = 1                                                0 Y                    VALID                           0 N                    N                    N                                                                                         
gvd4z9ba14uh3 select /* TESTFG */ count(*) from t1 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    N                                                                                         
221p0y74xg65x select /* TESTFG */ count(*) from t2 partition (p1)                                              0 Y                    VALID                           0 N                    N                    Y                                                                                         
7c65qbgku7can select /* TESTFG */ count(*) from t2 partition (p2)                                              0 Y                    VALID                           0 N                    N                    Y                                                                                         
czjk2xd0vn20k select /* TESTFG */ count(*) from t2 where id < (select max(id) from t1)                         0 Y                    VALID                           0 N                    N                    Y                                                                                         
1y9y6gg3r5sry select /* TESTFG */ count(*) from t2 where id = 1                                                0 Y                    VALID                           0 N                    N                    Y                                                                                         
dcvq5bcm8yqm9 select /* TESTFG */ count(*) from t2 where id = 1+150000                                         0 Y                    VALID                           0 N                    N                    Y                                                                                         
9jh4ms6ruztw2 select /* TESTFG */ count(*) from t2 where val1 = 1                                              0 Y                    VALID                           0 N                    N                    Y                                                                                         
bcsj7p128xh77 update /* TESTFG */ t1 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    N                                                                                         
bdhfwydh894qk update /* TESTFG */ t1 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    N                                                                                         
6a6m4fq5b9v7r update /* TESTFG */ t2 set val1 = val1 + 1 where id < 50                                         0 Y                    VALID                           0 N                    N                    Y                                                                                         
24qkp15shu1gp update /* TESTFG */ t2 set val1 = val1 + 1 where val1 < 50                                       0 Y                    VALID                           0 N                    N                    Y                                                                                         

14 rows selected.


no rows selected

SQL> 
SQL> 
SQL> 
SQL> 
SQL> 
SQL> 
